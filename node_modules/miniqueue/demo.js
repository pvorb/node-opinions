var Queue = require("./lib/miniqueue").Queue;

var numbers = new Queue(function(i, release) {
  console.info("I'm processing number", i);
  setTimeout(function() { // very long processing
    console.info("Done with number", i);
    release();
  }, 1000);
});

numbers.on("empty", function() {
  console.info("Queue is empty.");
});

var i;
for (i = 0; i < 3; ++i) {
  setTimeout(function(i) {
    console.info("Adding number", i);
    numbers.add(i);
  }.bind(undefined, i), 10);
}
